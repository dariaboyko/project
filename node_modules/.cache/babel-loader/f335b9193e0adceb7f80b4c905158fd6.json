{"ast":null,"code":"import actionPromise from \"./ActionPromise\";\n\nconst getGQL = url => function (query) {\n  let variables = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...(localStorage.authToken ? {\n        Authorization: \"Bearer \" + localStorage.authToken\n      } : {}),\n      Accept: \"application/json\"\n    },\n    body: JSON.stringify({\n      query,\n      variables\n    })\n  }).then(res => res.json()).then(data => {\n    if (data.data) {\n      return Object.values(data.data)[0];\n    } else throw new Error(JSON.stringify(data.errors));\n  });\n};\n\nconst URL = `http://shop-roles.node.ed.asmer.org.ua/`;\nconst gql = getGQL(`${URL}graphql`);\n\nconst actionAuthLogin = token => (dispatch, getState) => {\n  const oldState = getState().auth;\n  dispatch({\n    type: 'AUTH_LOGIN',\n    token\n  });\n  const newState = getState().auth;\n  localStorage.authToken = token;\n};\n\nconst actionFullLogin = (login, password) => async dispatch => {\n  const gqlQuery = `query log($login:String, $password:String){\n            login(login:$login, password:$password)\n        }`;\n  const gqlPromise = gql(gqlQuery, {\n    login,\n    password\n  });\n  const action = actionPromise('login', gqlPromise);\n  const result = await dispatch(action);\n  dispatch(actionAuthLogin(result));\n};\n\nexport default actionFullLogin;","map":{"version":3,"names":["actionPromise","getGQL","url","query","variables","fetch","method","headers","localStorage","authToken","Authorization","Accept","body","JSON","stringify","then","res","json","data","Object","values","Error","errors","URL","gql","actionAuthLogin","token","dispatch","getState","oldState","auth","type","newState","actionFullLogin","login","password","gqlQuery","gqlPromise","action","result"],"sources":["/Users/karen3/Documents/GitHub/project/src/components/ActionFullLogin.js"],"sourcesContent":["import actionPromise from \"./ActionPromise\";\nconst getGQL = url =>\n    (query, variables = {}) =>\n        fetch(url, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                ...(localStorage.authToken ? { Authorization: \"Bearer \" + localStorage.authToken } : {}),\n                Accept: \"application/json\",\n            },\n            body: JSON.stringify({ query, variables }),\n        })\n            .then((res) => res.json())\n            .then((data) => {\n                if (data.data) {\n                    return Object.values(data.data)[0];\n                } else throw new Error(JSON.stringify(data.errors));\n            });\n\nconst URL = `http://shop-roles.node.ed.asmer.org.ua/`\n\nconst gql = getGQL(`${URL}graphql`)\n\n\nconst actionAuthLogin = (token) => \n    (dispatch, getState) => {\n        const oldState = getState().auth\n        dispatch({type: 'AUTH_LOGIN', token})\n        const newState = getState().auth\n            localStorage.authToken = token     \n    }\n\nconst actionFullLogin = (login, password) =>\n    async (dispatch) => {\n        const gqlQuery = `query log($login:String, $password:String){\n            login(login:$login, password:$password)\n        }`\n        const gqlPromise = gql(gqlQuery, {login, password})\n        const action     = actionPromise('login', gqlPromise) \n        const result     = await dispatch(action)\n        dispatch(actionAuthLogin(result))\n    }\nexport default actionFullLogin;"],"mappings":"AAAA,OAAOA,aAAP,MAA0B,iBAA1B;;AACA,MAAMC,MAAM,GAAGC,GAAG,IACd,UAACC,KAAD;EAAA,IAAQC,SAAR,uEAAoB,EAApB;EAAA,OACIC,KAAK,CAACH,GAAD,EAAM;IACPI,MAAM,EAAE,MADD;IAEPC,OAAO,EAAE;MACL,gBAAgB,kBADX;MAEL,IAAIC,YAAY,CAACC,SAAb,GAAyB;QAAEC,aAAa,EAAE,YAAYF,YAAY,CAACC;MAA1C,CAAzB,GAAiF,EAArF,CAFK;MAGLE,MAAM,EAAE;IAHH,CAFF;IAOPC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;MAAEX,KAAF;MAASC;IAAT,CAAf;EAPC,CAAN,CAAL,CASKW,IATL,CASWC,GAAD,IAASA,GAAG,CAACC,IAAJ,EATnB,EAUKF,IAVL,CAUWG,IAAD,IAAU;IACZ,IAAIA,IAAI,CAACA,IAAT,EAAe;MACX,OAAOC,MAAM,CAACC,MAAP,CAAcF,IAAI,CAACA,IAAnB,EAAyB,CAAzB,CAAP;IACH,CAFD,MAEO,MAAM,IAAIG,KAAJ,CAAUR,IAAI,CAACC,SAAL,CAAeI,IAAI,CAACI,MAApB,CAAV,CAAN;EACV,CAdL,CADJ;AAAA,CADJ;;AAkBA,MAAMC,GAAG,GAAI,yCAAb;AAEA,MAAMC,GAAG,GAAGvB,MAAM,CAAE,GAAEsB,GAAI,SAAR,CAAlB;;AAGA,MAAME,eAAe,GAAIC,KAAD,IACpB,CAACC,QAAD,EAAWC,QAAX,KAAwB;EACpB,MAAMC,QAAQ,GAAGD,QAAQ,GAAGE,IAA5B;EACAH,QAAQ,CAAC;IAACI,IAAI,EAAE,YAAP;IAAqBL;EAArB,CAAD,CAAR;EACA,MAAMM,QAAQ,GAAGJ,QAAQ,GAAGE,IAA5B;EACItB,YAAY,CAACC,SAAb,GAAyBiB,KAAzB;AACP,CANL;;AAQA,MAAMO,eAAe,GAAG,CAACC,KAAD,EAAQC,QAAR,KACpB,MAAOR,QAAP,IAAoB;EAChB,MAAMS,QAAQ,GAAI;AAC1B;AACA,UAFQ;EAGA,MAAMC,UAAU,GAAGb,GAAG,CAACY,QAAD,EAAW;IAACF,KAAD;IAAQC;EAAR,CAAX,CAAtB;EACA,MAAMG,MAAM,GAAOtC,aAAa,CAAC,OAAD,EAAUqC,UAAV,CAAhC;EACA,MAAME,MAAM,GAAO,MAAMZ,QAAQ,CAACW,MAAD,CAAjC;EACAX,QAAQ,CAACF,eAAe,CAACc,MAAD,CAAhB,CAAR;AACH,CATL;;AAUA,eAAeN,eAAf"},"metadata":{},"sourceType":"module"}